<div class="token-list" [ngClass]="className">
  <!-- Header -->
  <div class="token-list-header">
    <h3>Available Tokens</h3>
    <div class="token-list-controls">
      <div class="search-container">
        <input
          type="text"
          placeholder="Search tokens..."
          [(ngModel)]="searchQuery"
          (ngModelChange)="handleSearchChange($event)"
          class="search-input"
        />
        <span class="search-icon">üîç</span>
      </div>
      
      <select
        [(ngModel)]="filterOptions.sortBy"
        (ngModelChange)="handleFilterChange({ sortBy: filterOptions.sortBy })"
        class="filter-select"
      >
        <option value="token_symbol">Sort by Symbol</option>
        <option value="token_name">Sort by Name</option>
        <option value="daily_volume_usd">Sort by Volume</option>
      </select>
      
      <select
        [(ngModel)]="filterOptions.sortOrder"
        (ngModelChange)="handleFilterChange({ sortOrder: filterOptions.sortOrder })"
        class="filter-select"
      >
        <option value="asc">Ascending</option>
        <option value="desc">Descending</option>
      </select>
    </div>
  </div>

  <!-- Loading State -->
  @if (loading) {
    <div class="token-list-loading">
      <div class="loading-spinner"></div>
      <span>Loading tokens...</span>
    </div>
  }

  <!-- Error State -->
  @if (error) {
    <div class="token-list-error">
      <span class="error-icon">‚ö†Ô∏è</span>
      <span>{{ error }}</span>
      <button (click)="fetchTokens()" class="retry-button">
        Retry
      </button>
    </div>
  }

  <!-- Token List -->
  @if (!loading && !error) {
    <div class="token-list-content">
      @if (tokens.length === 0) {
        <div class="no-tokens">
          <span>No tokens found</span>
        </div>
      } @else {
        <div class="token-grid">
          @for (token of tokens; track token.id) {
            <div
              class="token-card"
              [class.selected]="selectedTokenId === token.tokenId"
              (click)="handleTokenClick(token)"
            >
              <div class="token-header">
                <div class="token-symbol">
                  {{ token.token_symbol || token.symbol || 'N/A' }}
                </div>
                <div class="token-status">
                  @if (token.volume_updated_at) {
                    <span class="status-active">‚óè</span>
                  } @else {
                    <span class="status-inactive">‚óè</span>
                  }
                </div>
              </div>
              
              <div class="token-name">
                {{ token.token_name || token.name || 'Unknown Token' }}
              </div>
              
              <div class="token-address">
                {{ token.token_address }}
              </div>
              
              <div class="token-metrics">
                <div class="metric">
                  <span class="metric-label">Price:</span>
                  <span class="metric-value">{{ formatPrice(token.price) }}</span>
                </div>
                
                @if (token.change24h !== undefined) {
                  <div class="metric">
                    <span class="metric-label">24h Change:</span>
                    <span 
                      class="metric-value"
                      [class.positive]="token.change24h >= 0"
                      [class.negative]="token.change24h < 0"
                    >
                      {{ formatPercentage(token.change24h) }}
                    </span>
                  </div>
                }
                
                <div class="metric">
                  <span class="metric-label">24h Volume:</span>
                  <span class="metric-value">{{ formatVolume(token.daily_volume_usd) }}</span>
                </div>
              </div>
              
              <div class="token-footer">
                <span class="token-id">
                  ID: {{ token.id }}
                </span>
                <span class="token-chain">
                  Chain: {{ token.chain_id }}
                </span>
              </div>
            </div>
          }
        </div>
      }
    </div>
  }
</div>

